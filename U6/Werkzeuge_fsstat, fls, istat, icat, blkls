# Um die Metadaten, Sektorinhalte und FAT-Inhalte eines Datenträgerabbilds unter Kali Linux zu untersuchen, 
# können folgenden Werkzeuge und Befehle verwendendet werden: fsstat, fls, istat, icat, und blkls. 

--------------------------------------------------------------------------------------------------------------------------------------
# 1. fsstat - Dateisystemstatistik anzeigen
# Der Befehl fsstat zeigt Informationen über das Dateisystem des Datenträgerabbilds an.
----------------------------------------------------------------------------------
fsstat /dev/loop0
----------------------------------------------------------------------------------
# Beispiel:
fsstat /dev/loop0

--------------------------------------------------------------------------------------------------------------------------------------
# 2. fls - Dateien und Verzeichnisse auflisten
# Der Befehl fls listet die Dateien und Verzeichnisse des Dateisystems auf.
----------------------------------------------------------------------------------
fls -r /dev/loop0
----------------------------------------------------------------------------------
# Beispiel:
fls -r /dev/loop0

--------------------------------------------------------------------------------------------------------------------------------------
# 3. istat - Metadaten eines bestimmten Eintrags anzeigen
# Mit istat können Sie die Metadaten eines bestimmten Eintrags (z.B. einer Datei) anzeigen. 
# Sie benötigen die Inode-Nummer oder die Dateinummer, die Sie mit fls ermittelt haben.
----------------------------------------------------------------------------------
istat /dev/loop0 <inode_nummer>
----------------------------------------------------------------------------------
# Beispiel:
istat /dev/loop0 128

--------------------------------------------------------------------------------------------------------------------------------------
# 4. icat - Dateiinhalt extrahieren
# Der Befehl icat extrahiert den Inhalt einer Datei basierend auf der Inode-Nummer.
----------------------------------------------------------------------------------
icat /dev/loop0 <inode_nummer> > <ziel_datei>
----------------------------------------------------------------------------------
# Beispiel:
icat /dev/loop0 128 > extracted_file.txt

--------------------------------------------------------------------------------------------------------------------------------------
# 5. blkls - Unallozierten Speicherplatz extrahieren
# Mit blkls können Sie unallozierten Speicherplatz des Datenträgerabbilds extrahieren.
----------------------------------------------------------------------------------
blkls /dev/loop0 > <ziel_datei>
----------------------------------------------------------------------------------
# Beispiel:
blkls /dev/loop0 > unallocated_space.dd

--------------------------------------------------------------------------------------------------------------------------------------
# 6. FAT-Tabelleninhalt untersuchen
# Um die Inhalte der FAT (File Allocation Table) zu untersuchen, verwenden Sie fsstat. 
#  Suchen Sie in der Ausgabe nach der FAT-Information.
----------------------------------------------------------------------------------
fsstat /dev/loop0
----------------------------------------------------------------------------------
# Beispiel:
fsstat /dev/loop0
--------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------------------------------
# Beispielablauf
# Anzeige der Dateisystemstatistik
fsstat /dev/loop0
----------------------------------------------------------------------------------
# Auflisten der Dateien und Verzeichnisse
fls -r /dev/loop0
----------------------------------------------------------------------------------
# Metadaten eines bestimmten Eintrags anzeigen
istat /dev/loop0 128
----------------------------------------------------------------------------------
# Inhalt einer Datei extrahieren
icat /dev/loop0 128 > extracted_file.txt
----------------------------------------------------------------------------------
# Unallozierten Speicherplatz extrahieren
blkls /dev/loop0 > unallocated_space.dd
